\usepackage[dvipsnames]{xcolor}
\usepackage{tikz}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[inline]{enumitem}
\usepackage[textsize=tiny]{todonotes}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage{subcaption}
\usepackage{proof}
\usepackage{comment}
\usepackage{xspace}

\captionsetup[subfigure]{justification=centering}

% Categories - AC
\newcommand{\CT}{\ensuremath{\mathbf{CT}}}

% Properties of morphisms - AC 
% % \newcommand{\rdir}{\ensuremath{\mathit{rdir}}}
% % \newcommand{\rchd}{\ensuremath{\mathit{rchd}}}
% % \newcommand{\rsib}{\ensuremath{\mathit{rsib}}}
% \newcommand{\pdir}{\ensuremath{\mathit{pdir}}}
% \newcommand{\pchd}{\ensuremath{\mathit{pchd}}}
\newcommand{\prs}{{\mathsf{prs}}}
\newcommand{\rfl}{{\mathsf{rfl}}}

% Various - AC 
\newcommand{\entails}{\models}
\newcommand{\op}[1]{{#1}^{\mathrm{op}}}



\renewcommand{\to}{\rightarrow}
\newcommand{\ot}{\leftarrow}
\newcommand{\from}{\leftarrow}
\newcommand{\of}{{:}\,}
\newcommand{\trans}[1]{\xrightarrow{\xlabel{#1}}}
\newcommand{\trip}[3]{{#1}\trans{#2}{#3}}
%\newcommand{\parentsymb}{\pi}
%\newcommand{\parent}[1]{\parentsymb{#1}}

% Root of a tree
\newcommand{\rt}{\mathit{rt}}
\newcommand{\rtof}[1]{\rt_{#1}}
\newcommand{\setof}[1]{\{{#1}\}}
\newcommand{\gensetof}[2]{\setof{{#1}\mid{#2}}}
\newcommand{\tupof}[1]{\langle #1\rangle}
\newcommand{\st}{.\;}
\newcommand{\id}{{\mathit{id}}}
% Depth of a tree
\newcommand{\depth}{{\mathit{dp}}}
% Set of triples of a morhpism
\newcommand{\tp}{T}

% Direct parent relation
\newcommand{\parentof}[1][\mskip-1mu]{%
	\mathchoice{\mathrel{\prec\mskip-10mu\cdot_{#1}}}%
			   {\mathrel{\prec\mskip-10mu\cdot_{#1}}}%
			   {\mathrel{\prec\mskip-5mu\cdot_{#1}}}%
			   {\mathrel{\prec\mskip-5mu\cdot_{#1}}}%
}
% Transitive parent relation
\newcommand{\ancestof}{\prec}
% Transitive and reflexive parent relation
\newcommand{\ancesteq}{\preceq}
% Direct child relation
\newcommand{\childof}{%
    \mathrel{\mathchoice{\cdot\mskip-10mu\succ}%
                        {\cdot\mskip-10mu\succ}%
                        {\cdot\mskip-5mu\succ}%
                        {\cdot\mskip-5mu\succ}}%
}


\newcommand{\proper}{proper\xspace}


% Transitive child relation
\newcommand{\descof}{\succ}
% Transitive an reflexive child relation
\newcommand{\desceq}{\succeq}
% Sibling relation
\newcommand{\sibling}{\smallsmile}

\newcommand{\sat}{\models}
\newcommand{\nsat}{\not\sat}

% \mathsf label symbols
\newcommand{\la}{\mathsf{a}}
\newcommand{\lb}{\mathsf{b}}

% Universes
\newcommand{\Lab}{\mathit{Lab}}
\newcommand{\Var}{\mathit{Var}}

% FOL macros
\newcommand{\True}{\mathsf{true}}
\newcommand{\False}{\mathsf{false}}
\newcommand{\Eq}{\mathbin{\doteq}}
\newcommand{\fv}{\mathit{fv}}
\newcommand{\bv}{\mathit{bv}}
\newcommand{\iffdef}{:\Leftrightarrow}
\newcommand{\restr}{\restriction}
\newcommand{\ctx}[2]{\ensuremath{{#1} \mid {#2}}}

% Calligraphic symbols
\newcommand{\cC}{{\mathcal{C}}}
\newcommand{\cG}{{\mathcal{G}}}
\newcommand{\cH}{{\mathcal{H}}}
\newcommand{\cI}{{\mathcal{I}}}
\newcommand{\cJ}{{\mathcal{J}}}
\newcommand{\cM}{{\mathcal{M}}}
\newcommand{\cN}{{\mathcal{N}}}
\newcommand{\cP}{{\mathcal{P}}}
\newcommand{\cQ}{{\mathcal{Q}}}
\newcommand{\cR}{{\mathcal{R}}}
\newcommand{\cT}{{\mathcal{T}}}
\newcommand{\cU}{{\mathcal{U}}}
\newcommand{\cV}{{\mathcal{V}}}

\newcommand\E{^{\mathsf E}}
\newcommand\I{^{\mathsf I}}
\newcommand\N{^{\mathsf N}}
\renewcommand\P{^{\mathsf P}}
\newcommand\Q{^{\mathsf Q}}
\newcommand\U{^{\mathsf U}}

\newcommand{\natN}{\mathbb{N}}

\mathchardef\mhyphen="2D

\newcommand{\redir}[2][]{\mathsf{re\mhyphen dir}_{#1}(#2)}
\newcommand{\rechd}[2][]{\mathsf{re\mhyphen chd}_{#1}(#2)}
\newcommand{\resib}[2][]{\mathsf{re\mhyphen sib}_{#1}(#2)}

\newcommand{\isredir}[3][]{{#2}\in\redir[#1]{#3}}
\newcommand{\isrechd}[3][]{{#2}\in\rechd[#1]{#3}}
\newcommand{\isresib}[3][]{{#2}\in\resib[#1]{#3}}

\newcommand{\re}[2][]{\mathsf{re}_{#1}(#2)}

\newcommand{\rdir}{{\mathsf{r\mhyphen dir}}}
\newcommand{\rchd}{{\mathsf{r\mhyphen chd}}}
\newcommand{\rsib}{{\mathsf{r\mhyphen sib}}}
\newcommand{\rgen}{{\mathsf{r}}}

\newcommand{\fuse}{{\mathsf{fuse}}}

\newcommand{\pedir}[1]{\mathsf{pe\mhyphen dir}(#1)}
\newcommand{\peuniv}[1]{\mathsf{pe\mhyphen univ}(#1)}

\newcommand{\ispedir}[2]{{#1}\in\pedir{#2}}

\newcommand{\pdir}{{\mathsf{p\mhyphen dir}}}
\newcommand{\pchd}{{\mathsf{p\mhyphen chd}}}
\newcommand{\pgen}{{\mathsf{p}}}

\newcommand{\ishift}{{\mathsf{ishift}}}

\newenvironment{inumerate}{%
  \begin{enumerate*}[label=\emph{(\roman*)}]
}{%
  \end{enumerate*}
}

\usetikzlibrary{shapes.geometric}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{calc}

\colorlet{morphismColor}{blue!90!white}
\colorlet{openColor}{white!95!blue}

\tikzset{>=latex}
\tikzset{triangle/.style=
  {isosceles triangle,
   draw,
   shape border rotate=90,
   isosceles triangle stretches=true,
   anchor=top corner,
   minimum width=15mm,
   minimum height=15mm}}
\tikzset{graph/.style={
   inner sep=1pt,
   line width=3pt,
   draw=white,
   double=black}}
\tikzset{
  morphism/.style={
    color=#1,
    draw=#1,
  },
  morphism/.default={
    morphismColor
  }
}
\tikzset{medge/.style={
   line width=.8pt,
   double distance=0.4pt,
   double=blue,
   draw=white,
   >/.tip={Latex[color=blue,scale=.5]}
}}
\tikzset{over/.style={
   line width=.8pt,
   double distance=0.4pt,
   double=black,
   draw=white,
   arrows={|-|},
   >/.tip={Latex[color=black,scale=.5]}
}}
\tikzset{allcolor/.style= {
   draw={#1},
   text={#1},
   >/.tip={latex[color={#1}]}
}}

\tikzset{|/.tip={Bar[black,width=.4pt,line width=2pt]}}
\tikzset{cross/.style={
   preaction={draw=white,line width=2pt}
}}
\tikzset{opengraph/.style={
   ellipse,
   inner xsep=8,
   inner ysep=15,
   line width=0pt,
   fill=openColor,
   behind path
}}
\tikzset{doubleopengraph/.style={
   ellipse,
   inner xsep=8,
   inner ysep=25,
   fill=openColor,
   behind path
}}
\tikzset{openmorphism/.style={
  draw=white!95!blue,
  line width=4pt, 
  shorten <=-1pt,
  -stealth
}}

% Typeset the label of an extensible arrow by lowering the text
\newcommand{\xlabel}[1]{\smash{\mathchoice
		{\raisebox{-1.5pt}{$\scriptstyle#1$}}
		{\raisebox{-1.5pt}{$\scriptstyle#1$}}
		{\raisebox{-1pt}{$\scriptstyle#1$}}
		{\raisebox{-1pt}{$\scriptscriptstyle#1$}}
}}
% Typeset the label of an extensible arrow by lowering the text further
\newcommand{\xxlabel}[1]{\smash{\mathchoice
		{\raisebox{-3pt}{$\scriptstyle#1$}}
		{\raisebox{-3pt}{$\scriptstyle#1$}}
		{\raisebox{-2pt}{$\scriptstyle#1$}}
		{\raisebox{-2pt}{$\scriptscriptstyle#1$}}
}}
